;   >>>
;>>>
;>>>
;Input  Matrix File 1: C:\projects\ustm_resiliency\Base\Output\01_HIGHWAY_SKIMS.MAT
;Input  Matrix File 2: C:\projects\ustm_resiliency\Base\Output\01_LOADED_HIGHWAY_SKIMS.MAT
;Output Matrix File:   C:\projects\ustm_resiliency\Base\Output\01_HIGHWAY_SKIM_COMPARE.mat
;Table To Compare: 1:2
;*******************************************************************
;                   MATRIX COMPARISION SCRIPT                      *  
;*******************************************************************
; BY CITILABS
;
; THIS SCRIPT COMPARES TWO MATRICES AND REPORTS FREQUENCIES OF 
; DIFFERENCE AND DIFFERENCE RATIO AT USER-SPECIFIED RANGES.
; THE FREQUENCIES ARE FURTHER BROKEN INTO DIFFERENT VALUE GROUPS.
; 
; NOTE: IN THE CASE WHERE BASE VALUE = 0 AND SUBJECT VALUE >0,
;       THE DIFFERENCE RATIO IS SET TO 0. 
;;<<End Parameters>>;;
RUN PGM=MATRIX
FILEI MATI[1]="C:\projects\ustm_resiliency\Base\Output\01_HIGHWAY_SKIMS.MAT"
FILEI MATI[2]="C:\projects\ustm_resiliency\Base\Output\01_LOADED_HIGHWAY_SKIMS.MAT" 
FILEO MATO="C:\projects\ustm_resiliency\Base\Output\01_HIGHWAY_SKIM_COMPARE.mat", MO=2-4, NAME=DIFF, DIFFRATIO, BASE ; OUTPUT DIFFERENCES
 
  MW[1]=MI.1.1                              ; TRIP TABLE FROM FILE 1
  MW[4]=MI.2.1                              ; TRIP TABLE FROM FILE 2
  MW[2]=MW[4]-MW[1]                                 ; DIFFERENCE MATRIX = BASE1

  JLOOP
    IF (MW[1]=0 & MW[2]=0) CONTINUE                 ; CREATE RATIO MATRIX = BASE2; EXCLUDE UNUSED ZONE PAIRS
    IF (MW[1][J]<>0) MW[3][J]=MW[2][J]/MW[1][J]     ; CREATE INDEX MATRICES; PREVENT DIVISION BY ZERO
                                                    
    IF (MW[1][J]<=100)      
      MW[11][J]=1
    ELSEIF (MW[1][J]<=200)   
      MW[12][J]=1
    ELSEIF (MW[1][J]<=300)   
      MW[13][J]=1
    ELSEIF (MW[1][J]<=400)   
      MW[14][J]=1
    ELSEIF (MW[1][J]<=500)  
      MW[15][J]=1
    ELSEIF (MW[1][J]<=600) 
      MW[16][J]=1
    ELSE
      MW[17][J]=1
    ENDIF
  ENDJLOOP

  FREQUENCY BASEMW=2, VALUEMW=11, RANGE=-205,205,10,    TITLE='***DIFF FREQ FOR   0~100 CELLS***' 
  FREQUENCY BASEMW=2, VALUEMW=12, RANGE=-205,205,10,    TITLE='***DIFF FREQ FOR 100~200 CELLS***'
  FREQUENCY BASEMW=2, VALUEMW=13, RANGE=-205,205,10,    TITLE='***DIFF FREQ FOR 200~300 CELLS***'
  FREQUENCY BASEMW=2, VALUEMW=14, RANGE=-205,205,10,    TITLE='***DIFF FREQ FOR 300~400 CELLS***'
  FREQUENCY BASEMW=2, VALUEMW=15, RANGE=-205,205,10,    TITLE='***DIFF FREQ FOR 400~500 CELLS***'
  FREQUENCY BASEMW=2, VALUEMW=16, RANGE=-205,205,10,    TITLE='***DIFF FREQ FOR 500~600 CELLS***'
  FREQUENCY BASEMW=2, VALUEMW=17, RANGE=-205,205,10,    TITLE='***DIFF FREQ FOR 600+    CELLS***'
  FREQUENCY BASEMW=3, VALUEMW=11, RANGE=-2.05,2.05,0.1, TITLE='***DIFF RATIO FREQ FOR   0~100 CELLS***' 
  FREQUENCY BASEMW=3, VALUEMW=12, RANGE=-2.05,2.05,0.1, TITLE='***DIFF RATIO FREQ FOR 100~200 CELLS***'
  FREQUENCY BASEMW=3, VALUEMW=13, RANGE=-2.05,2.05,0.1, TITLE='***DIFF RATIO FREQ FOR 200~300 CELLS***'
  FREQUENCY BASEMW=3, VALUEMW=14, RANGE=-2.05,2.05,0.1, TITLE='***DIFF RATIO FREQ FOR 300~400 CELLS***'
  FREQUENCY BASEMW=3, VALUEMW=15, RANGE=-2.05,2.05,0.1, TITLE='***DIFF RATIO FREQ FOR 400~500 CELLS***'
  FREQUENCY BASEMW=3, VALUEMW=16, RANGE=-2.05,2.05,0.1, TITLE='***DIFF RATIO FREQ FOR 500~600 CELLS***'  
  FREQUENCY BASEMW=3, VALUEMW=17, RANGE=-2.05,2.05,0.1, TITLE='***DIFF RATIO FREQ FOR 600+    CELLS***'  
ENDRUN

